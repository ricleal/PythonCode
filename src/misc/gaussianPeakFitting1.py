'''
Created on Feb 22, 2013

@author: leal
'''

import numpy as np;
import matplotlib.pyplot as plt


gaussian = lambda x: 3*np.exp(-(30-x)**2/20.)
data = gaussian(np.arange(100))

arr = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,17,95,210,320,374,299,199,103,29,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
arr = [2383,379,359,386,376,385,408,399,380,384,381,391,395,424,434,436,443,481,545,549,564,571,570,531,547,619,536,558,563,602,595,615,576,629,628,587,622,662,692,699,761,800,833,882,898,940,918,859,879,851,810,766,701,636,679,624,575,515,496,518,432,461,462,428,458,419,368,400,371,415,414,381,357,372,363,425,377,329,366,347,350,316,345,363,373,373,354,365,350,335,327,337,327,307,322,294,317,339,294,258,270,295,299,274,270,253,244,228,286,246,246,245,243,251,211,268,226,245,239,248,211,244,227,220,221,211,224,226,212,198,224,222,207,187,212,223,202,224,196,190,197,184,203,189,210,204,196,177,190,183,198,171,207,185,177,169,195,187,157,175,203,185,186,190,187,171,179,187,172,182,202,178,167,181,194,178,167,186,182,170,182,168,183,196,182,146,158,160,175,148,172,163,185,152,175,156,172,186,169,151,185,142,146,145,158,164,170,158,161,134,142,168,171,154,143,153,138,172,153,164,149,167,162,133,154,166,171,136,166,160,152,176,138,140,120,174,141,152,156,160,143,181,207,198,254,284,290,375,450,509,801,3187,17245,71206,198205,402241,634402,810335,871807,819446,709139,601219,523270,468628,428849,398420,371919,351755,334851,318433,304715,293669,281271,271666,263951,253200,239614,219699,186808,145437,98333,57785,29552,14322,8058,6193,5624,5340,5185,4995,4574,4508,4350,4173,4045,3962,3772,3757,3804,3901,3945,4028,4160,4314,4172,4235,4282,4309,4279,4208,4089,4052,4096,3952,4048,4107,4005,3971,3903,3823,3885,3842,3603,3647,3676,3552,3581,3486,3360,3308,3285,3159,3176,3034,3080,2964,2958,2937,2983,2842,2823,2834,2853,2835,2731,2640,2737,2633,2770,2657,2585,2591,2622,2583,2609,2510,2484,2520,2536,2632,2467,2284,2444,2456,2483,2431,2471,2435,2409,2337,2373,2427,2435,2379,2383,2413,2312,2481,2333,2273,2338,2347,2288,2339,2353,2312,2262,2287,2356,2361,2239,2258,2211,2265,2227,2252,2228,2212,2285,2257,2259,2217,2200,2203,2299,2272,2203,2206,2251,2188,2204,2279,2076,2198,2029,2018,2044,2028,2000,1944,1963,1951,1865,1782,1802,1801,1724,1761,1654,1645,1596,1482,1549,1406,1420,1368,1385,1278,1336,1267,1314,1173,1171,1147,1136,1125,1090,1068,1008,982,966,990,959,862,859,878,814,824,787,790,835,768,730,720,716,703,718,634,716,633,631,617,611,598,549,618,579,544,513,528,524,533,549,515,501,471,443,397,472,421,423,458,432,432,407,420,413,417,409,396,380,377,389,414,373,364,329,362,363,324,354,331]
data = np.array(arr)

plt.plot(data,'-',label='Raw Data')

X = np.arange(data.size)

x = np.sum(X*data)/np.sum(data)

width = np.sqrt(np.abs(np.sum((X-x)**2*data)/np.sum(data)))

maxVal = data.max()

fit = lambda t : maxVal*np.exp(-(t-x)**2/(2*width**2))

plt.plot(fit(X),label='Fitting')

plt.legend()
plt.show()
